AWSTemplateFormatVersion: "2010-09-09"
Transform: AWS::Serverless-2016-10-31
Description: >
  Sample SAM Template for SamApp

# More info about Globals: https://github.com/awslabs/serverless-application-model/blob/master/docs/globals.rst
Globals:
  Function:
    MemorySize: 1024
    Architectures: ["x86_64"]
    Runtime: provided.al2
    Timeout: 10

    Tracing: Active

    Environment: # More info about Env Vars: https://github.com/awslabs/serverless-application-model/blob/master/versions/2016-10-31.md#environment-object
      Variables:
        COGNITO_AUTHORITY: https://cognito-idp.eu-central-1.amazonaws.com/eu-central-1_N5gpeDsBt
        CORS_ORIGIN: https://todo.k1ng.dev
        GOOGLE_CLIENT_ID: 103962427268-tcl37rkfkl20942mib207j7dk2v4or4d.apps.googleusercontent.com
  Api:
    TracingEnabled: true

Resources:
  ApiFunction:
    Type: AWS::Serverless::Function # More info about Function Resource: https://github.com/awslabs/serverless-application-model/blob/master/versions/2016-10-31.md#awsserverlessfunction
    Properties:
      FunctionName: TodoListLambdaFn
      Description: .NET WebAPI
      CodeUri: ./Server/
      Handler: bootstrap
      AutoPublishAlias: live
    Metadata:
      BuildMethod: makefile

  ApplicationResourceGroup:
    Type: AWS::ResourceGroups::Group
    Properties:
      Name:
        Fn::Sub: ApplicationInsights-SAM-${AWS::StackName}
      ResourceQuery:
        Type: CLOUDFORMATION_STACK_1_0

  ApplicationInsightsMonitoring:
    Type: AWS::ApplicationInsights::Application
    Properties:
      ResourceGroupName:
        Ref: ApplicationResourceGroup
      AutoConfigurationEnabled: "true"
